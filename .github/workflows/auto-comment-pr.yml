# .github/workflows/auto-comment-pr.yml

# Nome do Workflow: Este nome aparecer√° na aba "Actions" do seu reposit√≥rio GitHub.
name: Auto Comment on New PR

# Gatilho (Trigger): Define quando este workflow ser√° executado.
on:
  # Evento: pull_request
  pull_request:
    # Tipos: Especifica que o workflow deve rodar apenas quando uma PR for 'opened' (aberta).
    # Outros tipos comuns incluem 'reopened', 'synchronize' (quando novos commits s√£o adicionados), 'closed'.
    types: [opened]

# Trabalhos (Jobs): Define uma ou mais tarefas que o workflow executar√°.
jobs:
  # Nome do Job: Um nome descritivo para o trabalho.
  add-comment:
    # Runner: Especifica o tipo de m√°quina virtual que executar√° o job.
    # 'ubuntu-latest' √© uma escolha comum e geralmente a mais atualizada.
    runs-on: ubuntu-latest

    # Passos (Steps): Sequ√™ncia de tarefas que comp√µem o job.
    steps:
      # Passo 1: Adicionar o coment√°rio na Pull Request.
      - name: Add PR comment
        # A√ß√£o utilizada: actions/github-script@v7
        # Esta a√ß√£o permite executar scripts que podem interagir com a API do GitHub.
        # 'v7' √© a vers√£o da action. √â bom verificar periodicamente por vers√µes mais recentes.
        uses: actions/github-script@v7
        with:
          # Token do GitHub: Necess√°rio para autenticar e autorizar a action a interagir com seu reposit√≥rio.
          # O GITHUB_TOKEN √© um segredo especial fornecido automaticamente pelo GitHub Actions.
          # Ele tem permiss√µes limitadas ao reposit√≥rio onde o workflow est√° rodando.
          github-token: ${{ secrets.GITHUB_TOKEN }}
          # Script: O c√≥digo JavaScript que ser√° executado.
          script: |
            // Texto do coment√°rio que voc√™ deseja postar.
            // Voc√™ pode personalizar esta mensagem como quiser!
            const commentBody = `
            Ol√°! Obrigado por abrir esta Pull Request! üéâ

            Por favor, verifique os seguintes itens antes de prosseguir:
            - [ ] O c√≥digo segue os padr√µes de estilo do projeto.
            - [ ] Testes unit√°rios foram adicionados ou atualizados.
            - [ ] A documenta√ß√£o foi atualizada (se aplic√°vel).

            Nossa equipe ir√° revisar suas altera√ß√µes em breve.
            `;

            // Publica o coment√°rio na Pull Request.
            // github.rest.issues.createComment √© a fun√ß√£o do cliente Octokit para criar coment√°rios.
            await github.rest.issues.createComment({
              // owner: O propriet√°rio do reposit√≥rio (seu usu√°rio ou organiza√ß√£o).
              // context.repo.owner √© uma vari√°vel de contexto que cont√©m essa informa√ß√£o.
              owner: context.repo.owner,
              // repo: O nome do reposit√≥rio.
              // context.repo.repo √© uma vari√°vel de contexto que cont√©m essa informa√ß√£o.
              repo: context.repo.repo,
              // issue_number: O n√∫mero da Pull Request.
              // No contexto de uma Pull Request, context.issue.number refere-se ao n√∫mero da PR.
              issue_number: context.issue.number,
              // body: O conte√∫do do coment√°rio.
              body: commentBody
            });
            console.log(`Coment√°rio adicionado √† PR #${context.issue.number}`);